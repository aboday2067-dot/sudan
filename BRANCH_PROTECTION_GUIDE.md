# ðŸ”’ Ø­Ù…Ø§ÙŠØ© Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (Branch Protection)

## ÙƒÙŠÙÙŠØ© Ø­Ù…Ø§ÙŠØ© ÙØ±Ø¹ `main` Ù…Ù† Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª ØºÙŠØ± Ø§Ù„Ù…ØµØ±Ø­ Ø¨Ù‡Ø§

### Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰: Ø¹Ø¨Ø± GitHub (Ù…ÙˆØµÙ‰ Ø¨Ù‡Ø§)

#### Ø§Ù„Ø®Ø·ÙˆØ§Øª:

1. **Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„Ø±ÙŠØ¨Ùˆ Ø¹Ù„Ù‰ GitHub:**
   ```
   https://github.com/aboday2067-dot/sudan
   ```

2. **Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Settings (Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª)**
   - ÙÙŠ Ø£Ø¹Ù„Ù‰ Ø§Ù„ØµÙØ­Ø©ØŒ Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ ØªØ¨ÙˆÙŠØ¨ "Settings"

3. **Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Branches (Ø§Ù„ÙØ±ÙˆØ¹)**
   - Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©ØŒ Ø§Ø®ØªØ± "Branches"

4. **Ø£Ø¶Ù Ù‚Ø§Ø¹Ø¯Ø© Ø­Ù…Ø§ÙŠØ© (Branch Protection Rule)**
   - Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ "Add branch protection rule"
   - ÙÙŠ Ø®Ø§Ù†Ø© "Branch name pattern" Ø§ÙƒØªØ¨: `main`

5. **ÙØ¹Ù‘Ù„ Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:**

   #### âœ… Ø­Ù…Ø§ÙŠØ© Ø£Ø³Ø§Ø³ÙŠØ©:
   - â˜‘ï¸ **Require a pull request before merging**
     - ÙŠØ¬Ø¨ Ø¥Ù†Ø´Ø§Ø¡ PR Ù‚Ø¨Ù„ Ø§Ù„Ø¯Ù…Ø¬
   - â˜‘ï¸ **Require approvals** (1 approval)
     - ÙŠØªØ·Ù„Ø¨ Ù…ÙˆØ§ÙÙ‚ØªÙƒ Ù‚Ø¨Ù„ Ø§Ù„Ø¯Ù…Ø¬
   - â˜‘ï¸ **Dismiss stale pull request approvals**
     - Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ø¯ÙŠØ«

   #### âœ… Ø­Ù…Ø§ÙŠØ© Ù…ØªÙ‚Ø¯Ù…Ø©:
   - â˜‘ï¸ **Require status checks to pass**
     - Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ù†Ø¬Ø§Ø­ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª
   - â˜‘ï¸ **Require branches to be up to date**
     - ÙŠØ¬Ø¨ ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙØ±Ø¹ Ù‚Ø¨Ù„ Ø§Ù„Ø¯Ù…Ø¬
   - â˜‘ï¸ **Do not allow bypassing the above settings**
     - Ù„Ø§ ØªØ³Ù…Ø­ Ø¨ØªØ¬Ø§ÙˆØ² Ù‡Ø°Ù‡ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª

   #### ðŸ”’ Ø­Ù…Ø§ÙŠØ© Ù‚ØµÙˆÙ‰:
   - â˜‘ï¸ **Restrict who can push to matching branches**
     - Ø­Ø¯Ø¯ Ù…Ù† ÙŠØ³ØªØ·ÙŠØ¹ Ø§Ù„Ø¯ÙØ¹
     - Ø§Ø®ØªØ± Ù†ÙØ³Ùƒ ÙÙ‚Ø·
   - â˜‘ï¸ **Lock branch**
     - Ù‚ÙÙ„ Ø§Ù„ÙØ±Ø¹ ØªÙ…Ø§Ù…Ø§Ù‹ (Ù„Ù„Ù‚Ø±Ø§Ø¡Ø© ÙÙ‚Ø·)

6. **Ø§Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª:**
   - Ø§Ø¶ØºØ· "Create" Ø£Ùˆ "Save changes"

---

### Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©: Ø¹Ø¨Ø± GitHub CLI

Ø¥Ø°Ø§ ÙƒØ§Ù† Ù„Ø¯ÙŠÙƒ GitHub CLI Ù…Ø«Ø¨Øª:

```bash
# ØªØ«Ø¨ÙŠØª GitHub CLI (Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…Ø«Ø¨ØªØ§Ù‹)
# Ø¹Ù„Ù‰ Ubuntu/Debian:
sudo apt install gh

# Ø¹Ù„Ù‰ Mac:
brew install gh

# ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
gh auth login

# Ø­Ù…Ø§ÙŠØ© Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
gh api repos/aboday2067-dot/sudan/branches/main/protection \
  --method PUT \
  --field required_pull_request_reviews[required_approving_review_count]=1 \
  --field required_pull_request_reviews[dismiss_stale_reviews]=true \
  --field enforce_admins=true \
  --field restrictions[users][]=aboday2067-dot
```

---

### Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©: Ø§Ù„Ø±ÙŠØ¨Ùˆ Ø§Ù„Ø®Ø§Øµ (Private Repository)

Ø¥Ø°Ø§ Ø£Ø±Ø¯Øª Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø®Ø§ØµØ§Ù‹ ØªÙ…Ø§Ù…Ø§Ù‹:

#### Ø§Ù„Ø®Ø·ÙˆØ§Øª:

1. **Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Settings**
2. **ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„ØŒ Ø§Ø®ØªØ± "Danger Zone"**
3. **Ø§Ø¶ØºØ· "Change repository visibility"**
4. **Ø§Ø®ØªØ± "Make private"**
5. **Ø£ÙƒØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©**

**Ø§Ù„Ø¢Ù†:** Ù„Ø§ ÙŠØ³ØªØ·ÙŠØ¹ Ø£Ø­Ø¯ Ø±Ø¤ÙŠØ© Ø£Ùˆ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø±ÙŠØ¨Ùˆ Ø¥Ù„Ø§ Ø£Ù†Øª!

---

### Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…ÙˆØµÙ‰ Ø¨Ù‡Ø§

#### ðŸŸ¢ Ù„Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ø´Ø®ØµÙŠØ©:
```
âœ… Require pull request reviews
âœ… Require 1 approval (Ø£Ù†Øª)
âœ… Restrict push access (Ø£Ù†Øª ÙÙ‚Ø·)
```

#### ðŸŸ¡ Ù„Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ù…Ø¹ ÙØ±ÙŠÙ‚ Ù…ÙˆØ«ÙˆÙ‚:
```
âœ… Require pull request reviews
âœ… Require 2 approvals
âœ… Require status checks
âœ… Require up-to-date branches
```

#### ðŸ”´ Ù„Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ø­Ø³Ø§Ø³Ø©:
```
âœ… Lock branch (Ù‚ÙÙ„ ÙƒØ§Ù…Ù„)
âœ… Ø£Ùˆ Make repository private
âœ… + All protection rules
```

---

### Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ù…Ø§ÙŠØ©

Ø¨Ø¹Ø¯ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§ØªØŒ Ø¬Ø±Ø¨:

```bash
# Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø¯ÙØ¹ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¥Ù„Ù‰ main (ÙŠØ¬Ø¨ Ø£Ù† ØªÙØ´Ù„)
git checkout main
git commit --allow-empty -m "test"
git push origin main
# âŒ Ø³ØªØ±Ù‰: "protected branch hook declined"
```

**Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©:** Ø±ÙØ¶ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© âœ…

---

### Ø¥Ø¶Ø§ÙØ© Ù…ØªØ¹Ø§ÙˆÙ†ÙŠÙ† (Ø¥Ø°Ø§ Ø£Ø±Ø¯Øª)

Ø¥Ø°Ø§ Ø£Ø±Ø¯Øª Ø§Ù„Ø³Ù…Ø§Ø­ Ù„Ø£Ø´Ø®Ø§Øµ Ù…Ø¹ÙŠÙ†ÙŠÙ†:

1. **Settings â†’ Collaborators**
2. **Add people**
3. **Ø£Ø¯Ø®Ù„ username Ø£Ùˆ email**
4. **Ø­Ø¯Ø¯ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª:**
   - **Read**: Ù‚Ø±Ø§Ø¡Ø© ÙÙ‚Ø·
   - **Write**: ÙƒØªØ§Ø¨Ø© (Ù…Ø¹ Ø§Ù„ØªÙ‚ÙŠØ¯ Ø¨Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø­Ù…Ø§ÙŠØ©)
   - **Admin**: ØµÙ„Ø§Ø­ÙŠØ§Øª ÙƒØ§Ù…Ù„Ø©

---

### Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ø³Ø·Ø± Ø§Ù„Ø£ÙˆØ§Ù…Ø±

ÙŠÙ…ÙƒÙ†Ùƒ Ø£ÙŠØ¶Ø§Ù‹ Ø¥Ø¶Ø§ÙØ© hook Ù…Ø­Ù„ÙŠ:

```bash
# Ø¥Ù†Ø´Ø§Ø¡ pre-push hook
cat > .git/hooks/pre-push << 'EOF'
#!/bin/bash
protected_branch='main'
current_branch=$(git symbolic-ref HEAD | sed -e 's,.*/\(.*\),\1,')

if [ "$current_branch" = "$protected_branch" ]; then
    echo "ðŸš« Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¯ÙØ¹ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¥Ù„Ù‰ main!"
    echo "ðŸ“ Ø§Ø³ØªØ®Ø¯Ù… ÙØ±Ø¹ Ø¢Ø®Ø± ÙˆØ£Ù†Ø´Ø¦ PR"
    exit 1
fi
EOF

chmod +x .git/hooks/pre-push
```

---

## Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ù…Ø§ÙŠØ©

| Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© | Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø­Ù…Ø§ÙŠØ© | Ø§Ù„Ø³Ù‡ÙˆÙ„Ø© |
|---------|---------------|---------|
| GitHub Settings | ðŸŸ¢ Ø¹Ø§Ù„ÙŠ | Ø³Ù‡Ù„ Ø¬Ø¯Ø§Ù‹ |
| Private Repository | ðŸ”´ ÙƒØ§Ù…Ù„ | Ø³Ù‡Ù„ Ø¬Ø¯Ø§Ù‹ |
| Branch Protection | ðŸŸ¡ Ù…ØªÙˆØ³Ø· | Ù…ØªÙˆØ³Ø· |
| Local Hooks | ðŸŸ¢ Ù…Ø­Ù„ÙŠ | ØµØ¹Ø¨ Ù‚Ù„ÙŠÙ„Ø§Ù‹ |

---

## Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø·Ø¨Ù‚Ø© Ø­Ø§Ù„ÙŠØ§Ù‹

Ø¨Ø¹Ø¯ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù…Ø§ÙŠØ©ØŒ Ø³ØªÙƒÙˆÙ†:

âœ… **main Ù…Ø­Ù…ÙŠ**
- Ù„Ø§ Ø£Ø­Ø¯ ÙŠØ³ØªØ·ÙŠØ¹ Ø§Ù„Ø¯ÙØ¹ Ù…Ø¨Ø§Ø´Ø±Ø©
- ÙŠØ¬Ø¨ Ø¥Ù†Ø´Ø§Ø¡ PR
- ØªØ­ØªØ§Ø¬ Ù…ÙˆØ§ÙÙ‚ØªÙƒ Ù„Ù„Ø¯Ù…Ø¬

âœ… **Ø£Ù†Øª Ø§Ù„Ù…Ø§Ù„Ùƒ Ø§Ù„ÙˆØ­ÙŠØ¯**
- Ø£Ù†Øª Ù…Ù† ÙŠÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
- Ø£Ù†Øª Ù…Ù† ÙŠØ¯Ù…Ø¬ PRs
- Ø£Ù†Øª Ù…Ù† ÙŠØªØ­ÙƒÙ… Ø¨ÙƒÙ„ Ø´ÙŠØ¡

âœ… **Ø§Ù„Ø¢Ø®Ø±ÙˆÙ† (Ø¥Ø°Ø§ Ø£Ø¶ÙØªÙ‡Ù…)**
- ÙŠÙ…ÙƒÙ†Ù‡Ù… Ø¥Ù†Ø´Ø§Ø¡ ÙØ±ÙˆØ¹
- ÙŠÙ…ÙƒÙ†Ù‡Ù… Ø¥Ù†Ø´Ø§Ø¡ PRs
- Ù„Ø§ ÙŠÙ…ÙƒÙ†Ù‡Ù… Ø§Ù„Ø¯Ù…Ø¬ Ø¨Ø¯ÙˆÙ† Ù…ÙˆØ§ÙÙ‚ØªÙƒ

---

## Ø£Ø³Ø¦Ù„Ø© Ø´Ø§Ø¦Ø¹Ø©

### Ù‡Ù„ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø§Ù„Ø¯ÙØ¹ Ø¥Ù„Ù‰ mainØŸ
Ù†Ø¹Ù…ØŒ Ø£Ù†Øª Ø§Ù„Ù…Ø§Ù„ÙƒØŒ Ù„ÙƒÙ† Ø§Ù„Ø£ÙØ¶Ù„ Ø§Ø³ØªØ®Ø¯Ø§Ù… PRs Ù„Ù„ØªÙ†Ø¸ÙŠÙ….

### Ù…Ø§Ø°Ø§ Ù„Ùˆ Ù†Ø³ÙŠØª ÙˆØ­Ø§ÙˆÙ„Øª Ø§Ù„Ø¯ÙØ¹ Ù…Ø¨Ø§Ø´Ø±Ø©ØŸ
Ø³ÙŠØ±ÙØ¶ GitHub Ø§Ù„Ø¹Ù…Ù„ÙŠØ© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.

### Ù‡Ù„ ÙŠÙ…ÙƒÙ† Ù„Ù„Ø¢Ø®Ø±ÙŠÙ† Ø±Ø¤ÙŠØ© Ø§Ù„ÙƒÙˆØ¯ØŸ
- Ø¥Ø°Ø§ ÙƒØ§Ù† public: Ù†Ø¹Ù…ØŒ Ù„ÙƒÙ† Ù„Ø§ ÙŠÙ…ÙƒÙ†Ù‡Ù… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
- Ø¥Ø°Ø§ ÙƒØ§Ù† private: Ù„Ø§ØŒ Ø¥Ù„Ø§ Ø¥Ø°Ø§ Ø£Ø¶ÙØªÙ‡Ù…

### ÙƒÙŠÙ Ø£Ø³Ù…Ø­ Ù„Ø´Ø®Øµ Ø¨Ø§Ù„Ù…Ø³Ø§Ù‡Ù…Ø©ØŸ
Ø£Ø¶ÙÙ‡ ÙƒÙ€ Collaborator Ø¨ØµÙ„Ø§Ø­ÙŠØ© WriteØŒ ÙˆØ³ÙŠØªÙ‚ÙŠØ¯ Ø¨Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø­Ù…Ø§ÙŠØ©.

---

**Ø§Ù„Ø¢Ù† ÙØ±Ø¹Ùƒ Ù…Ø­Ù…ÙŠ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„! ðŸ”’**
